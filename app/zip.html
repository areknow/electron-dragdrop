<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Electron Zip Uncompress Files</title>
	 
</head>

<body>

    <input type="button" id="select-file" value="Select .zip file" />
    
	<script>
        var DecompressZip = require('decompress-zip');
        var app = require('electron').remote;
        var dialog = app.dialog;

        (function () {
            function uncompress(ZIP_FILE_PATH, DESTINATION_PATH){
                var unzipper = new DecompressZip(ZIP_FILE_PATH);

                // Add the error event listener
                unzipper.on('error', function (err) {
//                    console.log('Caught an error', err);
                });
                
                // Notify when everything is extracted
                unzipper.on('extract', function (log) {
//                    console.log('Finished extracting', log);
                });
                
                // Notify "progress" of the decompressed files
                unzipper.on('progress', function (fileIndex, fileCount) {
//                    console.log('Extracted file ' + (fileIndex + 1) + ' of ' + fileCount);
                });
                
                // Unzip !
                unzipper.extract({
                    path: DESTINATION_PATH
                });
            }

            document.getElementById("select-file").addEventListener("click", () => {
                // Select the .zip file
                dialog.showOpenDialog({
                    title:"Select the .zip file to decompress"
                },function (fileNames) {
                    // fileNames is an array that contains the selected file
                    if(fileNames === undefined){
//                        console.log("No file selected");
                        return;
                    }else{
                        // Select destination folder

                      console.log(fileNames[0])
                      uncompress(fileNames[0],"tmp");
//                        dialog.showOpenDialog({
//                            title:"Select destination folder where the content should be decompressed",
//                            properties: ["openDirectory"]
//                        },function (folderPaths) {
//                                // folderPaths is an array that contains all the selected paths
//                            if(fileNames === undefined){
////                                console.log("No destination folder selected");
//                                return;
//                            }else{
////                              console.log(folderPaths[0])
//                                // Proceed to decompress
//                                uncompress(fileNames[0],folderPaths[0]);
//                                uncompress(fileNames[0],"tmp");
//                            }
//                        });
                    }
                });          
            }, false);
        })();
    </script>
</body>

</html>